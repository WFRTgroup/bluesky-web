# Testing run status and output APIs using existing exported outputs

## setup

Using the following runs, each in http://pg.blueskywebhost.com/playground-output/,
 - Success: $RUN_ID_1
 - Non-existent: foobar1
 - Failed: $RUN_ID_2

First, grab input

    mkdir -p /bsp-output/from-playground/
    mkdir /bsp-output/from-playground/$RUN_ID_1/
    mkdir /bsp-output/from-playground/$RUN_ID_2

    cd /bsp-output/from-playground/$RUN_ID_1/ && wget http://pg.blueskywebhost.com/playground-output/$RUN_ID_1/output.json
    cd /bsp-output/from-playground/$RUN_ID_2 && wget http://pg.blueskywebhost.com/playground-output/$RUN_ID_2/output.json

## start server

### Upload

    BSPWEB_EXPORT_MODE=upload \
        BSPWEB_EXPORT_UPLOAD_SCP_USER=jdubowy \
        BSPWEB_EXPORT_UPLOAD_SCP_HOST=pg.blueskywebhost.com \
        ./bin/bsp-web -d --log-level=DEBUG

### localsave

    BSPWEB_EXPORT_MODE=localsave \
        BSPWEB_EXPORT_LOCALSAVE_DEST_DIR=/bsp-output/from-playground/ \
        ./bin/bsp-web -d --log-level=DEBUG

### upload where upload server is the same as request server

this is really conrived, since he upload scp host wouldn't eveb localhost

    BSPWEB_EXPORT_MODE=upload \
        BSPWEB_EXPORT_UPLOAD_SCP_DEST_DIR=/bsp-output/from-playground/ \
        BSPWEB_EXPORT_UPLOAD_SCP_USER=jdubowy \
        BSPWEB_EXPORT_UPLOAD_SCP_HOST=localhost \
        ./bin/bsp-web -d --log-level=DEBUG

## test

### status

    curl -D - http://localhost:8888/api/v1/run/$RUN_ID_1/status  # success
    curl -D - http://localhost:8888/api/v1/run/foobar1/status  # non-existent
    curl -D - http://localhost:8888/api/v1/run/$RUN_ID_2/status  # failed

### output:

    curl -D - http://localhost:8888/api/v1/run/$RUN_ID_1/output  # success
    curl -D - http://localhost:8888/api/v1/run/foobar1/output  # non-existent
    curl -D - http://localhost:8888/api/v1/run/$RUN_ID_2/output  # failed


## Testing end to end

make sure scheduler system is working with bsp workers

post requests

    ...
